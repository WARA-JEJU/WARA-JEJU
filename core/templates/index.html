<!DOCTYPE HTML>
<html>
	<head>
		{% load static %}
		<title>WARA-JEJU</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="{% static "css/main.css" %}" />
		<style>
			a.disabled {
			  pointer-events: none;
			  cursor: default;
			  background-color: grey !important;
			}
		</style>
	</head>
	<body class="homepage is-preload">

		<form id="routeRecommendation" method="get">
			<div id="page-wrapper">
				<!-- Header -->
				<section id="header">
					<div class="container">
						<!-- Logo -->
						<h1 id="logo"><a href="index.html">WARA-JEJU</a></h1>
						<p>바쁜 사람들을 위해 선택한 일정 최적의 경로 추천 시스템</p>
						<br>
						<br>
							<div class="row gtr-50">
								<div class="col-6 col-12-small">
									<input name="name" placeholder="제주 스타벅스" type="text" value="{{ request.GET.name }}"/>
								</div>
								<div class="col-12">
									<a id="request" class="form-button-submit button icon solid fa-envelope">검색하기</a>
								</div>
							</div>
						<!-- Nav -->
						<nav id="nav">
							<ul>
								<li><a class="icon solid fa-home" href="profile/"><span>일정 계획</span></a></li>
								<li><a class="icon solid fa-home" href="schedule_list/"><span>스케줄</span></a></li>
								<li><a class="icon solid fa-home" href="route_recommend/"><span>경로 추천(완료)</span></a></li>
							</ul>
						</nav>
					</div>
				</section>
				<!-- Main -->
				<section id="main">
					<div class="container">
						<div class="row">
							<div id="sidebar" class="col-4 col-12-medium">
								<!-- Highlights -->
								{% include 'include.html' %}
							</div>
						</div>
					</div>
				</section>
			</div>
			<input type="hidden" id="count" name="count" value="0">
		<!-- Scripts -->
		<script src="{% static "js/jquery.min.js" %}"></script>
		<script src="{% static "js/jquery.dropotron.min.js" %}"></script>
		<script src="{% static "js/browser.min.js" %}"></script>
		<script src="{% static "js/breakpoints.min.js" %}"></script>
		<script src="{% static "js/util.js" %}"></script>
		<script src="{% static "js/main.js" %}"></script>
		<script>
			function setCoordinate(x, y, 상호명){
				if(x != '' && y != '' && 상호명 != ''){
					var html = "";
					html += '<a class="link depth-0" href="javascript:;" onclick="$(this).remove();';
					html += '$(\'#';
					html += $("#routeRecommendation").find("input[type='hidden']").length - 1;
					html += "')";
					html += '.remove();" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><span class="indent-0"></span> - ';
					html += 상호명;
					html += '</a>';
					$("nav").append(html);

					html = "";
					html += "<input type='hidden' value='";
					html += x;
					html += ", ";
					html += y;
					html += ", ";
					html += 상호명;
					html += "'";
					html += "name='";
					html += $("#routeRecommendation").find("input[type='hidden']").length - 1;
					html += "'";
					html += "id='";
					html += $("#routeRecommendation").find("input[type='hidden']").length - 1;
					html += "'";
					html += "'>";
					$("#routeRecommendation").append(html);

					$(this).attr('disabled', true);
					$("#count").val($("#routeRecommendation").find("input[type='hidden']").length - 1);
				}
			}

			 // 'request'라는 id를 가진 버튼 클릭 시 실행.
   			 $("#request").click(function(){
   			 	var params = jQuery("#routeRecommendation").serialize();
   			 	console.log(params)
				$.ajax({
					type : "POST",            // HTTP method type(GET, POST) 형식이다.
					url : "find/",            // 컨트롤러에서 대기중인 URL 주소이다.
					data : params,            // Json 형식의 데이터이다.
					success : function(res){  // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
						console.log(res)
					},
					error : function(XMLHttpRequest, textStatus, errorThrown){ // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
						alert("통신 실패.")
					}
				});
			});
		</script>
	</body>
</html>